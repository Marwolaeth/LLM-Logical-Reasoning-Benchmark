---
title: "Оценка логических способностей LLM с помощью vitals и Ollama: Глубокое погружение"
author: "Andrej Pawluczenko"
format: docx
---

## Введение

Наше исследование изучает способность больших языковых моделей (LLM) к логическому рассуждению. Несмотря на успехи в генерации текста и понимании контекста, вопрос о логических способностях LLM остается предметом обсуждений. Существующие исследования языковых моделей показывают [ССЫЛКИ НА ИССЛЕДОВАНИЯ], что их рассуждения могут отличаться от человеческих. Понимание этих различий имеет не просто академический интерес; оно имеет решающее значение для безопасного и эффективного применения LLM в сферах, требующих безупречной логики, таких как принятие решений, анализ данных и разработка экспертных систем.

Проект использует доступный логический тест, изначально разработанный для оценки мыслительных способностей человека. Этот подход позволяет нам не только количественно измерить производительность различных LLM в задачах логического вывода, но и провести прямое сравнение их рассуждений с человеческими паттернами. Используя такой человеко-ориентированный бенчмарк, мы можем глубже понять, насколько хорошо LLM имитируют или отклоняются от человеческой логики, а также выявить конкретные типы логических ошибок, с которыми они сталкиваются.

## О тесте

Логический тест, разработанный математиком Мирославом Войнаровским, состоит из 30 пунктов. Каждый пункт включает «Условие» и три «Следствия», из которых только одно является правильным.

Некоторые особенности теста, на которые обращает внимание сам автор в своем описании:

- тест не требует специальных математических или философских знаний;
- все слова следует толковать буквально, в их повседневном русском значении, без метафор;
- ключевой особенностью теста является использование незнакомых слов, таких как «куздра», «шмурдик» или «уузка», которые помогают оценить чистое логическое мышление, отделяя его от общих знаний об окружающем мире;
- если встречаются противоположные по смыслу слова (например, «умеет» и «не умеет»), предполагается отсутствие промежуточных вариантов.

Пример вопроса:

**Условие**: Шмурдик боится как мышей, так и тараканов.

**Варианты**:
a) шмурдик не боится тараканов;
b) шмурдик боится мышей;
c) шмурдик боится мышей больше, чем тараканов, но и тараканов боится тоже.

Этот тест активно используется при отборе кандидатов на вакансии в различных сферах, поскольку он позволяет оценить способность соискателей к логическому мышлению. Например, в одной компании проходной балл установлен на уровне 26 правильных ответов (86,67% точности) — это решение было принято после того, как дочь руководителя, обычная 14-летняя девочка, набрала именно столько баллов, став своеобразным эталоном для оценки логических способностей кандидатов. Интересно будет посмотреть, смогут ли современные языковые модели превзойти этот результат.

## Технологии

Проект реализован на языке программирования R, который был выбран благодаря своей удобности, развитой экосистеме и высокой культуре написания документации и руководств. R традиционно силен в статистике и анализе данных, что делает его отличным выбором для проектов, требующих систематического тестирования и оценки результатов, как в нашем случае с оценкой больших языковых моделей.

Для взаимодействия с большими языковыми моделями (LLM) мы используем R-библиотеку `ellmer`. Эта библиотека значительно упрощает работу с различными провайдерами LLM, включая Google Gemini, OpenAI, Anthropic и другие. Среди поддерживаемых бэкендов, для нашего проекта мы выбрали **Ollama** — платформу, позволяющую легко запускать большие языковые модели локально на вашем компьютере.

Выбор Ollama обусловлен несколькими ключевыми факторами, связанными с ограничениями нашего проекта: минимальным бюджетом и скромными аппаратными возможностями (обычный рабочий компьютер со старой видеокартой Intel и небольшим жестким диском). Ollama позволяет запускать множество моделей, оптимизированных для локального использования, что исключает затраты на облачные API и снижает требования к интернет-соединению. Для некоторых моделей, особенно небольших, мы также использовали **LM Studio** — еще одну удобную платформу для запуска больших языковых моделей локально, предоставляющую графический интерфейс для загрузки и управления моделями. Это делает тестирование доступным даже на оборудовании, которое не предназначено для высокопроизводительных вычислений. Кроме того, `ellmer` в связке с Ollama и LM Studio позволяет реализовать **структурированный вывод**, что имеет огромную практическую ценность для нашего анализа. Вместо генерации свободного текста, мы можем запросить у LLM ответ в строго определенном формате (например, JSON), что значительно упрощает автоматическую обработку и валидацию результатов логического теста, повышая точность и эффективность оценки.

Для систематической оценки производительности LLM на логическом тесте мы применяем фреймворк `vitals`. Эта библиотека предназначена для измерения эффективности продуктов на основе LLM, позволяя сравнивать различные модели, оценивать влияние изменений в промптах и выявлять проблемное поведение. `vitals` упрощает процесс создания задач оценки, где мы определяем набор входных данных (вопросы теста), "«ешатель» (LLM через `ellmer` и Ollama/LM Studio) и «оценщика» (логику для сравнения ответов LLM с правильными ответами). Таким образом, `vitals` является незаменимым инструментом для объективной и воспроизводимой оценки того, насколько хорошо различные языковые модели справляются с логическим тестом Войнаровского, и позволяет нам определить, какие из них могут превзойти результат 14-летней девочки. Важно отметить, что в рамках этого проекта мы тестировали относительно небольшие модели, такие как `qwen3:4b`, `aya-expanse:8b`, `mistral:7b`, `llama3.1:8b`, `llama-3.2-1b-instruct`, `gemma-2-2b-instruct-structured-output` и `phi4`, самая большая из которых (`phi4`) имеет размер около 9 Гб и содержит 14 миллиардов параметров. Вероятно, более крупные и мощные коммерческие модели показали бы другие результаты.

## Цитаты
…
> Поскольку в послании говорится, что шмурдик боится как мышей, так и тараканов, то ни одна из гипотез не является логическим следствием посылки. Однако, если рассмотреть все три гипотез вместе, то можно сделать вывод, что правильной ответом будет 'c', поскольку в послании говорится, что шмурдик боится как мышей, так и тараканов, а гипотеза c) предполагает, что шмурдик боится мышей больше, чем тараканов, но и тараканов боится тоже.

(ALIENTELLIGENCE/structureddataextraction)

> Ответ: 'b' - шмурдик боится мышей. Посылка говорит, что Шмурдик боится как мышей, так и тараканов. Это означает, что он не может не бояться мышей (поскольку утверждается, что он их боится), но можно лишь предположить, что он боится тараканов (поскольку в посылке говорится, что он боится и тараканов). Поэтому гипотеза 'a) шмурдик не боится тараканов' является ложной. Гипотеза 'c) шмурдик боится мышей больше, чем  тараканов, но и тараканов боится тоже' также является ложной, поскольку в посылке не говорится о том, что  Шмурдик боится тараканов больше, чем мышей. Поэтому единственно верной гипотезой является 'b) шмурдик боится мышей'.

(mistral:7b)

> Ни одна из гипотез не является логическим следствием посылки. Посылка говорит о том, что Шмурдик боится как мышей, так и тараканов. Это означает, что он боится обоих (мышей и тараканов), но не говорится ничего о степени страха или отсутствии страха. Поэтому никакая из гипотез не может быть выведена из посылки.

(mistral:7b)

> Поскольку шмурдик боится как мышей, так и тараканов, это означает, что он не боится ни одной из этих двух видов. Следовательно, гипотеза a) "шмурдик не боится тараканов" является логическим следствием посылки.
Гипотезы b) и c) неверны, поскольку они предполагают, что шмурдик боится мышей или то, что он боится мышей больше, чем тараканов, но это противоречит тому факту, что он боится как мышей, так и тараканов.

(малышка llama3.2)

> Чтобы определить единственную гипотезу \( H_i \), которая является логическим следствием посылки (P), давайте проанализируем каждую из них:
Посылка (P): Шмурдик боится как мышей, так и тараканов.
Гипотезы:
- \( H_a \): шмурдик не боится тараканов.
- \( H_b \): шмурдик боится мышей.
- \( H_c \): шмурдик боится мышей больше, чем тараканов, но и тараканов боится тоже.
Анализ:
1. Гипотеза \( H_a \) утверждает, что Шмурдик не боится тараканов. Это прямо противоречит посылке (P), которая гласит, что он боится и тараканов. Следовательно, \( H_a \) не является логическим следствием.
2. Гипотеза \( H_b \) утверждает, что Шмурдик боится мышей. Это согласуется с посылкой (P), которая говорит, что он боится как мышей, так и тараканов. Таким образом, \( H_b \) является логическим следствием.
3. Гипотеза \( H_c \) утверждает, что Шмурдик боится мышей больше, чем тараканов, но и тараканов боится тоже. Хотя это согласуется с посылкой в отношении страха перед тараканами, она добавляет дополнительную информацию (степень страха), которая не подтверждается посылкой. Посылка говорит только о наличии страха, но не о его сравнении.
Таким образом, единственная гипотеза, которая является логическим следствием посылки (P), это \( H_b \).
Ответ: 'b'

(умничка phi4)

> Хорошо, давай разберёмся с этой задачей по NLI. У нас есть посылка (P): "Шмурд: боится как мышей, так и тараканов." Нужно определить, какая из гипотез (a, b, c) логически следует из этой посылки.
Сначала я должен понять, что значит посылка. То есть, шмурдик боится мышей и тараканов. То есть, оба объекта (мыши и тараканы) вызывают страх у шмурдика.
Теперь посмотрю на гипотезы:
a) шмурдик не боится тараканов;
Это противоречит посылке, потому что посылка говорит, что шмурдик боится тараканов. Значит, гипотеза a ложна, не следует.
b) шмурдик боится мышей;
В посылке сказано, что шмурдик боится как мышей, так и тараканов. То есть, мыши и тараканы оба входят в список объектов, которые шмурдик боится. Значит, гипотеза b верна, потому что часть утверждения посылки — это то, что он боится мышей.
c) шмурдик боится мышей больше, чем тараканов, но и тараканов боится тоже.
Здесь есть два утверждения: 1) боится мышей больше, чем тараканов; 2) боится тараканов тоже. Но посылка не упоминает о количестве. В посылке просто сказано, что он боится обеими. Нет информации о том, что он боится больше мышей. Поэтому гипотеза c добавляет информацию о количестве, которая не содержится в посылке. Следовательно, c не следует из посылки.
Таким образом, правильный ответ — b.
Но давай проверю ещё раз. В посылке "боится как мышей, так и тараканов" — это означает, что он боится обеих. То есть, логически, это утверждение эквивалентно "шмурдик боится мышей и шмурдик боится тараканов". Тогда гипотеза b — это часть этого утверждения, поэтому она логически следует. Гипотеза c добавляет сравнение количества, которое не указано в посылке, поэтому не следует. Гипотеза a прямо противоположна посылке.
Да, точно, ответ b.
</think>
b

(qwen3:4b)

> Хорошо, давай разберёмся с этой задачей. У нас есть посылка P: "Шмурд: боится как мышей, так и тараканов." Нужно определить, какая из гипотез a, b, c логически выводится из этой посылки.
Сначала я должен понять, что значит посылка. В русском языке "боится как мышей, так и тараканов" означает, что шмурдик боится обеих групп: мышей и тараканов. То есть, посылка утверждает, что шмурдик боится мышей и тараканов одновременно.
Теперь посмотрю на гипотезы:
a) шмурдик не боится тараканов;
b) шмурдик боится мышей;
c) шмурдик боится мышей больше, чем тараканов, но и тараканов боится тоже.
Нужно проверить, какая из этих гипотез следует из посылки P.
Начнём с гипотезы a: "шмурдик не боится тараканов". Но посылка говорит, что шмурдик боится тараканов. Значит, гипотеза a противоречит посылке. То есть a не следует из P, а наоборот, P отрицает a. Значит, a не правильный ответ.
Гипотеза b: "шмурдик боится мышей". Посылка утверждает, что шмурдик боится и мышей, и тараканов. То есть, если он боится обеих, то в частности, он боится мышей. Значит, гипотеза b логически следует из посылки P. Потому что если P истинно, то мыши и тараканы входят в множество объектов, которые шмурдик боится. Поэтому b должно быть правильным.
Но давай проверим гипотезу c. Она говорит: "шмурдик боится мышей больше, чем тараканов, но и тараканов боится тоже". Здесь есть два утверждения: 1) шмурдик боится мышей больше, чем тараканов; 2) шмурдик боится тараканов. Посылка P утверждает, что шмурдик боится обеих, то есть тараканов и мышей. Но в гипотезе c есть утверждение о количественном сравнении: "боится мышей больше, чем тараканов". Однако посылка P не даёт информации о количестве, только о том, что оба вида животных вызывают страх. То есть, посылка не утверждает, что шмурдик боится мышей больше, чем тараканов. Поэтому гипотеза c включает дополнительное утверждение о количестве, которое не следует из посылки. Следовательно, c не является логическим следствием P.
Таким образом, правильный ответ — b.
Но подожди, может быть, я что-то упустил? Давай ещё раз проверим.
Посылка: шмурдик боится как мышей, так и тараканов. То есть, это два объекта: мыши и тараканы. В логике это обычно означает, что шмурдик боится мышей и тараканов, то есть оба условия истинны.
Гипотеза b: шмурдик боится мышей. Да, это следует, потому что если он боится оба, то мыши включены.
Гипотеза c: "боится мышей больше, чем тараканов, но и тараканов боится тоже". Здесь "больше" — это количественное сравнение, которое не упоминается в посылке. Посылка не говорит о количестве, только о том, что оба вида вызывают страх. Поэтому c не следует, так как в ней есть утверждение о количестве, которое не подтверждается посылкой.
Так что ответ b.
Но в задании сказано "какая из гипотез (a, b, c) логически выводится из посылки". То есть, только одна из них. По логике, если посылка P — это "шмурдик боится мышей и тараканов", то это конъюнкция двух утверждений: "шмурдик боится мышей" и "шмурдик боится тараканов". Тогда из P можно вывести оба утверждения. То есть, b — это одно из них, а также утверждение о тараканах. Но в гипотезах у нас есть только b и другие.
Гипотеза b — это "шмурдик боится мышей", что прямо следует из P. Гипотеза a — отрицание тараканов, что противоречит P. Гипотеза c — содержит сравнение количества, что не следует.
Поэтому ответ b.
Но в некоторых случаях может быть нюанс. Например, в русском языке "боится как мышей, так и тараканов" может быть интерпретировано как "боится мышей и тараканов", то есть оба. То есть, это конъюнкция. Тогда из P следует, что шмурдик боится мышей (b) и тараканов. Но в гипотезах только b и другие. Поэтому b — правильный ответ.
Да, я думаю, что ответ b.
</think>
b

(qwen3:4b)

> Ни одна из гипотез не является логическим следствием посылки. 
Предположим, что шмурдик боится мышей и тараканов. Это означает, что он боится как мышей, так и тараканов (посылка). Ни один из вариантов ответа (a, b или c) не является логическим следствием этого утверждения.
Вариант a: "Шмурдик не боится тараканов" - это противоречие посылки. 
Вариант b: "Шмурдик боится мышей" - это часть посылки, но не логическое следствие.
Вариант c: "Шмурдик боится мышей больше, чем тараканов, но и тараканов боится тоже" - это противоречие посылке. 
Следовательно, ни один из вариантов ответа (a, b или c) не является логическим следствием посылки.

(ALIENTELLIGENCE/structureddataextraction)

> Логически, из утверждения "Шмурдик боится как мышей, так и тараканов" не следует сделать однозначного вывода о том, насколько сильно шмурдик боится каждого из этих насекомых. Однако можно сделать следующие логические заключения:
a) Шмурдик не боится тараканов (это неверно, так как посылка утверждает именно обратное).
b) Шмурдик боится мышей (это верно, так как посылка говорит о том, что он боится их).
c) Шмурдик боится мышей больше, чем тараканов, но и тараканов боится тоже (это также верно, так как посылка утверждает, что он боится и мышей, и тараканов).
Таким образом, гипотезы a и c являются логическими следствиями посылки, но ответ "a" или "c" зависит от того, какую гипотезу вы хотите подтвердить или опровергнуть с помощью исходной посылки. В данном контексте, если хочется подтвердить, что шмурдик боится мышей, то верным будет ответ "b". Если же хочется узнать, что он боится тараканов, то ответ "a" (хотя в данном случае это уже известно, что это неверно). Гипотеза c является логически верной, так как включает в себя обе части посылки.

(wizardlm2)

> Поскольку шмурдик боится как мышей, так и тараканов, то его гипотеза «а» не является логическим следствием посылки.
С другой стороны, гипотеза «б» — это логический следствие посылки, поскольку она основана на том факте, что шмурдик боится мышей.
Гипотеза «с» также является логическим следствием посылки, поскольку она предполагает, что шмурдик боится мышей больше, чем тараканов.

(llama-3.2-1b-instruct)

> Поскольку шмурдик боится мышей, а тараканы боятся мышей, то шмурдик не боится тараканов. Следовательно, правильный ответ — **а)**.
Анализ:
* Гипотеза (a) неверна, поскольку шмурдик боится мышей.
* Гипотеза (b) неверна, поскольку шмурдик боится мышей, а тараканы боятся мышей.
* Гипотеза (c) верна, поскольку шмурдик боится мышей больше, чем тараканов.
Окончательный ответ: **a**.

(llama-3.2-1b-instruct)

> Ответ: 'c'. Гипотеза 'c' является логическим следствием посылки, поскольку она учитывает обе опасения Шмурдика упомянутые в посылке. Гипотезы 'a' и 'b' противоречат посылке, утверждая, что Шмурдик боится только одного из этих животных.

(openhermes)

> Поскольку в послании говорится, что Шмурдик боится как мышей, так и тараканов, то логическим следствием послания будет гипотеза a), которая утверждает, что шмурдик не боится тараканов. 
Окончательный ответ — a).

(llama3.1:8b)

…